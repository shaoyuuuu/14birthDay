# 后端用户管理API实现计划

## 1. 问题分析
前端用户管理页面已经实现，但后端缺少对应的API支持。前端期望的API路径是 `/users`，但后端目前只实现了 `/user` 路径，并且只提供了个人资料管理功能，没有提供用户列表、创建用户、编辑用户和删除用户等管理功能。

## 2. 实现步骤

### 2.1 创建用户管理路由
- 在 `src/routes/` 目录下创建 `users.js` 文件（注意是复数形式）
- 实现用户管理相关的API端点

### 2.2 实现用户管理API
- `GET /api/users` - 获取用户列表，支持分页、搜索和过滤
- `GET /api/users/:id` - 获取单个用户详情
- `POST /api/users` - 创建新用户
- `PUT /api/users/:id` - 更新用户信息
- `DELETE /api/users/:id` - 删除用户
- `GET /api/users/roles` - 获取可用角色列表

### 2.3 更新数据库查询
- 使用现有的数据库连接
- 查询 `admins` 表（从现有代码中可以看到用户数据存储在 admins 表中）

### 2.4 添加权限控制
- 使用现有的 `authMiddleware` 和 `requirePermission` 中间件
- 为用户管理API添加适当的权限控制

### 2.5 更新服务器路由配置
- 在 `src/server.js` 中添加用户管理路由

## 3. 技术实现
- 使用 Express.js 框架
- 使用 PostgreSQL 数据库
- 使用现有的认证和权限中间件
- 遵循现有的代码风格和响应格式

## 4. 预期效果
- 前端用户管理页面能够正常请求后端API
- 支持获取用户列表、创建用户、编辑用户和删除用户等功能
- 保持与现有系统的安全性和可靠性
- 提供适当的错误处理和响应格式