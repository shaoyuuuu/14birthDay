const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Typewriter-UAuF6lJT.js","assets/js/gsap-DdPmJgzX.js","assets/js/_plugin-vue_export-helper-BCo6x5W8.js","assets/js/element-plus-8tyzJLX6.js","assets/css/Typewriter-CDb1RmrE.css","assets/js/MemoryPage-DwkiondZ.js","assets/css/MemoryPage-CEiMNnmX.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(r,t,o)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o,s=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&n(e,a,s[a]);if(r)for(var a of r(s))o.call(s,a)&&n(e,a,s[a]);return e};import{r as a,c as l,w as i,o as c,a as u,b as d,u as m,d as p,e as g,f as h,E as f,g as y,h as E,i as b}from"./element-plus-8tyzJLX6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();const v={},w=function(e,r,t){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));o=Promise.allSettled(r.map(e=>{if((e=function(e){return"/14birthDay/"+e}(e))in v)return;v[e]=!0;const r=e.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const n=document.createElement("link");return n.rel=r?"stylesheet":"modulepreload",r||(n.as="script"),n.crossOrigin="",n.href=e,t&&n.setAttribute("nonce",t),document.head.appendChild(n),r?new Promise((r,t)=>{n.addEventListener("load",r),n.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=e,window.dispatchEvent(r),!r.defaultPrevented)throw e}return o.then(r=>{for(const e of r||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},L=a({currentSection:"typewriter",isLoading:!1,error:null,memories:[],currentMemory:null,currentTheme:null,imagesLoaded:!1,loadingProgress:0,preferences:{autoPlay:!1,autoPlayInterval:5e3,animationSpeed:1,soundEnabled:!1}});l(()=>null!==L.error),l(()=>L.memories.length>0);const P=l(()=>L.currentMemory?L.memories.findIndex(e=>e.folderName===L.currentMemory.folderName):-1),O=l(()=>P.value<L.memories.length-1),S=l(()=>P.value>0),R={setCurrentSection(e){L.currentSection=e},setLoading(e){L.isLoading=e},setError(e){L.error=e},clearError(){L.error=null},setMemories(e){L.memories=e},addMemory(e){L.memories.push(e)},updateMemory(e,r){const t=L.memories.findIndex(r=>r.folderName===e);-1!==t&&(L.memories[t]=s(s({},L.memories[t]),r))},setCurrentMemory(e){L.currentMemory=e},nextMemory(){O.value&&(L.currentMemory=L.memories[P.value+1])},previousMemory(){S.value&&(L.currentMemory=L.memories[P.value-1])},setCurrentTheme(e){L.currentTheme=e},setImagesLoaded(e){L.imagesLoaded=e},setLoadingProgress(e){L.loadingProgress=e},updatePreferences(e){L.preferences=s(s({},L.preferences),e)},reset(){L.currentSection="typewriter",L.isLoading=!1,L.error=null,L.currentMemory=null,L.currentTheme=null,L.imagesLoaded=!1,L.loadingProgress=0}};i(()=>L.preferences,e=>{try{localStorage.setItem("userPreferences",JSON.stringify(e))}catch(r){}},{deep:!0});const M={class:"app"},_={key:0,id:"typewriter-section",class:"section"},k={key:1,id:"timeline-section",class:"section"},C={__name:"App",setup(e){const r=h(()=>w(()=>import("./Typewriter-UAuF6lJT.js"),__vite__mapDeps([0,1,2,3,4]))),t=h(()=>w(()=>import("./MemoryPage-DwkiondZ.js"),__vite__mapDeps([5,2,3,1,6])));c(()=>{(()=>{try{const e=localStorage.getItem("userPreferences");if(e){const r=JSON.parse(e);L.preferences=s(s({},L.preferences),r)}}catch(e){}})()});const o=()=>{R.setCurrentSection("timeline")};return(e,n)=>(g(),u("div",M,["typewriter"===m(L).currentSection?(g(),u("section",_,[p(m(r),{onTypewriterComplete:o})])):d("",!0),"timeline"===m(L).currentSection?(g(),u("section",k,[p(m(t))])):d("",!0)]))}},N="NETWORK_ERROR",I="API_ERROR",T="VALIDATION_ERROR",x="RESOURCE_ERROR",A="UNKNOWN_ERROR";class j extends Error{constructor(e,r=A,t=null){super(e),this.name="AppError",this.type=r,this.originalError=t,this.timestamp=(new Date).toISOString()}}class H extends j{constructor(e,r=null){super(e,N,r),this.name="NetworkError"}}class D extends j{constructor(e,r=null,t=null){super(e,I,t),this.name="ApiError",this.statusCode=r}}class U extends j{constructor(e,r=null,t=null){super(e,x,t),this.name="ResourceError",this.resource=r}}const z=new class{constructor(){this.errorLog=[],this.maxLogSize=100,this.errorHandlers=new Map,this.globalErrorCallback=null}setGlobalErrorCallback(e){this.globalErrorCallback=e}registerErrorHandler(e,r){this.errorHandlers.set(e,r)}handleError(e,r={}){const t=this.normalizeError(e);this.logError(t,r);(this.errorHandlers.get(t.type)||this.defaultErrorHandler).call(this,t,r),this.globalErrorCallback&&this.globalErrorCallback(t,r)}normalizeError(e){return e instanceof j?e:e instanceof TypeError||e instanceof ReferenceError?new j(e.message,A,e):e.message&&e.message.includes("Failed to fetch")?new H("网络连接失败，请检查网络设置",e):e.message&&e.message.includes("HTTP error")?new D("API请求失败",null,e):e.message&&e.message.includes("加载")?new U("资源加载失败",null,e):new j(e.message||"未知错误",A,e)}logError(e,r){const t={error:{message:e.message,type:e.type,name:e.name,timestamp:e.timestamp},context:r,stack:e.stack};this.errorLog.push(t),this.errorLog.length>this.maxLogSize&&this.errorLog.shift()}defaultErrorHandler(e,r){this.getUserFriendlyMessage(e)}getUserFriendlyMessage(e){const r=this.normalizeError(e);return{[N]:"网络连接失败，请检查您的网络设置",[I]:"数据加载失败，请稍后重试",[T]:"输入数据有误，请检查后重试",[x]:"资源加载失败，请刷新页面重试",[A]:"发生未知错误，请稍后重试"}[r.type]||r.message||"发生错误，请稍后重试"}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}retry(e,r=3,t=1e3){return o=this,n=null,s=function*(){let o;for(let s=0;s<r;s++)try{return yield e()}catch(n){o=n,s<r-1&&(yield new Promise(e=>setTimeout(e,t*(s+1))))}throw o},new Promise((e,r)=>{var t=e=>{try{l(s.next(e))}catch(t){r(t)}},a=e=>{try{l(s.throw(e))}catch(t){r(t)}},l=r=>r.done?e(r.value):Promise.resolve(r.value).then(t,a);l((s=s.apply(o,n)).next())});var o,n,s}};z.registerErrorHandler(N,(e,r)=>{}),z.registerErrorHandler(I,(e,r)=>{}),z.registerErrorHandler(x,(e,r)=>{}),z&&"function"==typeof z.setGlobalErrorCallback&&z.setGlobalErrorCallback((e,r)=>{void 0!==f&&f.error(z.getUserFriendlyMessage(e))}),window.addEventListener("unhandledrejection",e=>{z&&"function"==typeof z.handleError&&z.handleError(e.reason,{unhandledRejection:!0}),e.preventDefault()}),window.addEventListener("error",e=>{z&&"function"==typeof z.handleError&&z.handleError(e.error,{globalError:!0})});const F=y(C);F.use(E),F.use(b),F.use(f),F.mount("#app");export{D as A,H as N,w as _,z as e};
